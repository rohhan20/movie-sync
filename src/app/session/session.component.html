<div class="session-container" *ngIf="filteredSession$ | async as session">
  <div class="session-header">
    <h1>Session Code: {{ session.id }}</h1>
    <button mat-raised-button color="warn" (click)="leaveSession()">Leave Session</button>
  </div>

  <div class="session-content">
    <div class="members-container">
      <h2>Members in Session</h2>
      <mat-list>
        <mat-list-item *ngFor="let memberId of session.members">
          {{ memberId }}
        </mat-list-item>
      </mat-list>
    </div>

    <div class="recommendations-container">
      <h2>Common Recommendations</h2>
      <div>
        <mat-form-field>
          <mat-label>Genre</mat-label>
          <mat-select [(ngModel)]="selectedGenre" (selectionChange)="applyFilters()">
            <mat-option value="">All</mat-option>
            <mat-option *ngFor="let genre of genres" [value]="genre">{{ genre }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-label>Year</mat-label>
        <mat-slider min="1990" max="2024" step="1">
          <input matSliderThumb [(ngModel)]="selectedYear" (input)="applyFilters()">
        </mat-slider>

        <mat-label>Rating</mat-label>
        <mat-slider min="1" max="10" step="0.1">
          <input matSliderThumb [(ngModel)]="selectedRating" (input)="applyFilters()">
        </mat-slider>
      </div>
      <mat-grid-list cols="3" rowHeight="400px" gutterSize="16px" *ngIf="session.recommendations?.length; else noRecommendations">
        <mat-grid-tile *ngFor="let movie of session.recommendations">
          <mat-card class="movie-card">
            <img mat-card-image [src]="movie.posterUrl" [alt]="movie.title">
            <mat-card-header>
              <mat-card-title>{{ movie.title }}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <p>{{ movie.description }}</p>
            </mat-card-content>
          </mat-card>
        </mat-grid-tile>
      </mat-grid-list>
      <ng-template #noRecommendations>
        <p>No common recommendations found yet. Invite more friends!</p>
      </ng-template>
    </div>
  </div>
</div>
